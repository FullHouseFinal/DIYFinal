
/* Drop SEQUENCE */

DROP SEQUENCE FURNITURENUM_SEQ;
DROP SEQUENCE GALLERYNUM_SEQ;
DROP SEQUENCE REPLYNUM_SEQ;

/* Create SEQUENCE */

CREATE SEQUENCE FURNITURENUM_SEQ;
CREATE SEQUENCE GALLERYNUM_SEQ;
CREATE SEQUENCE REPLYNUM_SEQ;

/* Drop Tables */

DROP TABLE ITR_RECORD CASCADE CONSTRAINTS;
DROP TABLE ITR_FURNITURE CASCADE CONSTRAINTS;
DROP TABLE ITR_COMPANY CASCADE CONSTRAINTS;
DROP TABLE ITR_REPLY CASCADE CONSTRAINTS;
DROP TABLE ITR_GALLERY CASCADE CONSTRAINTS;
DROP TABLE ITR_IMG CASCADE CONSTRAINTS;
DROP TABLE ITR_MODEL CASCADE CONSTRAINTS;
DROP TABLE ITR_USER CASCADE CONSTRAINTS;

/* Create Tables */

-- ITR_COMPANY : FURNITURE의 3D모델을 업로드할 수 있는 기업회원
CREATE TABLE ITR_COMPANY
(
	-- COMPANY 회사명 : COMPANY 회사명
	CONAME VARCHAR2(20) NOT NULL,
	-- COMPANY 아이디 : COMPANY 아이디
	COID VARCHAR2(20) NOT NULL,
	-- COMPANY 비밀번호 : COMPANY 비밀번호
	COPWD VARCHAR2(20) NOT NULL,
	-- COMPANY 전화번호 : COMPANY 전화번호
	COTEL VARCHAR2(20) NOT NULL,
	-- COMPANY 담당자이름 : COMPANY 담당자이름
	COMANAGERNAME VARCHAR2(10) NOT NULL,
	-- COMPANY 담당자의 소속 부서 : COMPANY 담당자의 소속 부서
	COMANAGERDEPT VARCHAR2(20),
	-- COMANAGEREMAIL : COMPANY 담당자의 이메일
	COMANAGEREMAIL VARCHAR2(30) NOT NULL UNIQUE,
	-- COMPANY 승인여부
	COAUTHORITY NUMBER DEFAULT 0,
	PRIMARY KEY (CONAME)
);

-- ITR_FURNITURE : 회사 혹은 관리자가 업로드한 가구의 3D모델
CREATE TABLE ITR_FURNITURE
(
	-- FURNITURE 번호 : FURNITURE 번호
	FURNITURENUM NUMBER NOT NULL,
	-- COMPANY 회사명 : COMPANY 회사명
	CONAME VARCHAR2(20) NOT NULL,
	-- FURNITURE 이름 : FURNITURE 이름
	FURNITURENAME VARCHAR2(20) NOT NULL,
	-- FURNITURE 종류 : FURNITURE 종류
	TYPE VARCHAR2(20) NOT NULL,
	-- FURNITURE 색상 : FURNITURE 색상
	COLOR VARCHAR2(20) NOT NULL,
	PRIMARY KEY (FURNITURENUM)
);

-- ITR_GALLERY : USER가 작성한 글과 캡처이미지 및 기타 정보를 DB에 저장
CREATE TABLE ITR_GALLERY
(
	-- GALLERY 번호 : GALLERY 번호
	GALLERYNUM NUMBER NOT NULL,
	-- USER 아이디 : USER 아이디
	ID VARCHAR2(20) NOT NULL,
	-- IMG 서버에 저장되는 파일명 : IMG 서버에 저장되는 파일명
	IMGUUID VARCHAR2(20),
	-- GALLERY 제목 : GALLERY 제목
	TITLE VARCHAR2(50) NOT NULL,
	-- GALLERY 내용 : GALLERY 내용
	CONTENT VARCHAR2(1000),
	-- GALLERY 작성 날짜 : GALLERY 작성 날짜
	INPUTDATE TIMESTAMP DEFAULT SYSDATE,
	-- GALLERY 조회수 : GALLERY 조회수
	HIT NUMBER DEFAULT 0,
	PRIMARY KEY (GALLERYNUM)
);

-- ITR_IMG : USER가 3D모델을 캡처한 이미지의 파일명을 UUID로 서버에 저장
CREATE TABLE ITR_IMG
(
	-- IMG 서버에 저장되는 파일명 : IMG 서버에 저장되는 파일명
	IMGUUID VARCHAR2(20) NOT NULL,
	-- MODEL 서버에 저장되는 파일명 : MODEL 서버에 저장되는 파일명
	MODELUUID VARCHAR2(20) NOT NULL,
	-- USER 아이디 : USER 아이디
	ID VARCHAR2(20) NOT NULL,
	-- IMG 이름 : IMG 이름
	IMG_NAME VARCHAR2(20) NOT NULL,
	-- IMG 저장 날짜 : IMG 저장 날짜
	SAVEDDATE TIMESTAMP DEFAULT SYSDATE,
	PRIMARY KEY (IMGUUID)
);

-- ITR_MODEL : USER가 제작한 3D모델파일의 파일명을 UUID로 서버에 저장
CREATE TABLE ITR_MODEL
(
	-- MODEL 서버에 저장되는 파일명 : MODEL 서버에 저장되는 파일명
	MODELUUID VARCHAR2(20) NOT NULL,
	-- USER 아이디 : USER 아이디
	ID VARCHAR2(20) NOT NULL,
	-- MODEL 이름 : MODEL 이름
	MODELNAME VARCHAR2(20) NOT NULL,
	-- MODEL 최초 제작 날짜 : MODEL 최초 제작 날짜
	CREATEDATE TIMESTAMP DEFAULT SYSDATE,
	-- MODEL 최근 수정 날짜 : MODEL 최근 수정 날짜
	MODIFYDATE TIMESTAMP DEFAULT SYSDATE,
	PRIMARY KEY (MODELUUID)
);

-- ITR_RECORD : 성별과 연령별로 종합된 추천 가구 목록
CREATE TABLE ITR_RECORD
(
	-- FURNITURE 번호 : FURNITURE 번호
	FURNITURENUM NUMBER NOT NULL,
	-- USER 아이디 : USER 아이디
	ID VARCHAR2(20) NOT NULL,
	-- USER가 가구를 사용한 횟수 : USER가 가구를 사용한 횟수
	PICK NUMBER DEFAULT 1
);

-- ITR_REPLY : USER가 작성한 덧글을 DB에 저장
CREATE TABLE ITR_REPLY
(
	-- REPLY 번호 : REPLY 번호
	REPLYNUM NUMBER NOT NULL,
	-- GALLERY 번호 : GALLERY 번호
	GALLERYNUM NUMBER NOT NULL,
	-- USER 아이디 : USER 아이디
	ID VARCHAR2(20) NOT NULL,
	-- REPLY 내용 : REPLY 내용
	TEXT VARCHAR2(100) NOT NULL,
	-- REPLY 작성 날짜 : REPLY 작성 날짜
	INPUTDATE TIMESTAMP DEFAULT SYSDATE,
	PRIMARY KEY (REPLYNUM)
);

-- ITR_USER : 기업회원이 아닌 가입된 USER의 정보
CREATE TABLE ITR_USER
(
	-- USER 아이디 : USER 아이디
	ID VARCHAR2(20) NOT NULL,
	-- USER 비밀번호 : USER 비밀번호
	PWD VARCHAR2(20) NOT NULL,
	-- USER 이름 : USER 이름
	NAME VARCHAR2(20) NOT NULL,
	-- USER 이메일 : USER 이메일
	EMAIL VARCHAR2(50) NOT NULL UNIQUE,
	-- USER 성별 : USER 성별
	GENDER VARCHAR2(10) NOT NULL,
	-- USER 생년월일 : USER 생년월일
	BIRTH TIMESTAMP NOT NULL,
	PRIMARY KEY (ID)
);

/* Create Foreign Keys */

ALTER TABLE ITR_FURNITURE
	ADD FOREIGN KEY (CONAME)
	REFERENCES ITR_COMPANY (CONAME)
;

ALTER TABLE ITR_RECORD
	ADD FOREIGN KEY (FURNITURENUM)
	REFERENCES ITR_FURNITURE (FURNITURENUM)
;

ALTER TABLE ITR_REPLY
	ADD FOREIGN KEY (GALLERYNUM)
	REFERENCES ITR_GALLERY (GALLERYNUM)
;

ALTER TABLE ITR_GALLERY
	ADD FOREIGN KEY (IMGUUID)
	REFERENCES ITR_IMG (IMGUUID)
;

ALTER TABLE ITR_IMG
	ADD FOREIGN KEY (MODELUUID)
	REFERENCES ITR_MODEL (MODELUUID)
;

ALTER TABLE ITR_GALLERY
	ADD FOREIGN KEY (ID)
	REFERENCES ITR_USER (ID)
;

ALTER TABLE ITR_IMG
	ADD FOREIGN KEY (ID)
	REFERENCES ITR_USER (ID)
;

ALTER TABLE ITR_MODEL
	ADD FOREIGN KEY (ID)
	REFERENCES ITR_USER (ID)
;

ALTER TABLE ITR_RECORD
	ADD FOREIGN KEY (ID)
	REFERENCES ITR_USER (ID)
;

ALTER TABLE ITR_REPLY
	ADD FOREIGN KEY (ID)
	REFERENCES ITR_USER (ID)
;

/* Comments */

COMMENT ON TABLE ITR_COMPANY IS 'ITR_COMPANY : FURNITURE의 3D모델을 업로드할 수 있는 기업회원';
COMMENT ON COLUMN ITR_COMPANY.CONAME IS 'COMPANY 회사명 : COMPANY 회사명';
COMMENT ON COLUMN ITR_COMPANY.COID IS 'COMPANY 아이디 : COMPANY 아이디';
COMMENT ON COLUMN ITR_COMPANY.COPWD IS 'COMPANY 비밀번호 : COMPANY 비밀번호';
COMMENT ON COLUMN ITR_COMPANY.COTEL IS 'COMPANY 전화번호 : COMPANY 전화번호';
COMMENT ON COLUMN ITR_COMPANY.COMANAGERNAME IS 'COMPANY 담당자이름 : COMPANY 담당자이름';
COMMENT ON COLUMN ITR_COMPANY.COMANAGERDEPT IS 'COMPANY 담당자의 소속 부서 : COMPANY 담당자의 소속 부서';
COMMENT ON COLUMN ITR_COMPANY.COMANAGEREMAIL IS 'COMANAGEREMAIL : COMPANY 담당자의 이메일';
COMMENT ON COLUMN ITR_COMPANY.COAUTHORITY IS 'COMPANY 승인여부';
COMMENT ON TABLE ITR_FURNITURE IS 'ITR_FURNITURE : 회사 혹은 관리자가 업로드한 가구의 3D모델';
COMMENT ON COLUMN ITR_FURNITURE.FURNITURENUM IS 'FURNITURE 번호 : FURNITURE 번호';
COMMENT ON COLUMN ITR_FURNITURE.CONAME IS 'COMPANY 회사명 : COMPANY 회사명';
COMMENT ON COLUMN ITR_FURNITURE.FURNITURENAME IS 'FURNITURE 이름 : FURNITURE 이름';
COMMENT ON COLUMN ITR_FURNITURE.TYPE IS 'FURNITURE 종류 : FURNITURE 종류';
COMMENT ON COLUMN ITR_FURNITURE.COLOR IS 'FURNITURE 색상 : FURNITURE 색상';
COMMENT ON TABLE ITR_GALLERY IS 'ITR_GALLERY : USER가 작성한 글과 캡처이미지 및 기타 정보를 DB에 저장';
COMMENT ON COLUMN ITR_GALLERY.GALLERYNUM IS 'GALLERY 번호 : GALLERY 번호';
COMMENT ON COLUMN ITR_GALLERY.ID IS 'USER 아이디 : USER 아이디';
COMMENT ON COLUMN ITR_GALLERY.IMGUUID IS 'IMG 서버에 저장되는 파일명 : IMG 서버에 저장되는 파일명';
COMMENT ON COLUMN ITR_GALLERY.TITLE IS 'GALLERY 제목 : GALLERY 제목';
COMMENT ON COLUMN ITR_GALLERY.CONTENT IS 'GALLERY 내용 : GALLERY 내용';
COMMENT ON COLUMN ITR_GALLERY.INPUTDATE IS 'GALLERY 작성 날짜 : GALLERY 작성 날짜';
COMMENT ON COLUMN ITR_GALLERY.HIT IS 'GALLERY 조회수 : GALLERY 조회수';
COMMENT ON TABLE ITR_IMG IS 'ITR_IMG : USER가 3D모델을 캡처한 이미지의 파일명을 UUID로 서버에 저장';
COMMENT ON COLUMN ITR_IMG.IMGUUID IS 'IMG 서버에 저장되는 파일명 : IMG 서버에 저장되는 파일명';
COMMENT ON COLUMN ITR_IMG.MODELUUID IS 'MODEL 서버에 저장되는 파일명 : MODEL 서버에 저장되는 파일명';
COMMENT ON COLUMN ITR_IMG.ID IS 'USER 아이디 : USER 아이디';
COMMENT ON COLUMN ITR_IMG.IMG_NAME IS 'IMG 이름 : IMG 이름';
COMMENT ON COLUMN ITR_IMG.SAVEDDATE IS 'IMG 저장 날짜 : IMG 저장 날짜';
COMMENT ON TABLE ITR_MODEL IS 'ITR_MODEL : USER가 제작한 3D모델파일의 파일명을 UUID로 서버에 저장';
COMMENT ON COLUMN ITR_MODEL.MODELUUID IS 'MODEL 서버에 저장되는 파일명 : MODEL 서버에 저장되는 파일명';
COMMENT ON COLUMN ITR_MODEL.ID IS 'USER 아이디 : USER 아이디';
COMMENT ON COLUMN ITR_MODEL.MODELNAME IS 'MODEL 이름 : MODEL 이름';
COMMENT ON COLUMN ITR_MODEL.CREATEDATE IS 'MODEL 최초 제작 날짜 : MODEL 최초 제작 날짜';
COMMENT ON COLUMN ITR_MODEL.MODIFYDATE IS 'MODEL 최근 수정 날짜 : MODEL 최근 수정 날짜';
COMMENT ON TABLE ITR_RECORD IS 'ITR_RECORD : 성별과 연령별로 종합된 추천 가구 목록';
COMMENT ON COLUMN ITR_RECORD.FURNITURENUM IS 'FURNITURE 번호 : FURNITURE 번호';
COMMENT ON COLUMN ITR_RECORD.ID IS 'USER 아이디 : USER 아이디';
COMMENT ON COLUMN ITR_RECORD.PICK IS 'USER가 가구를 사용한 횟수 : USER가 가구를 사용한 횟수';
COMMENT ON TABLE ITR_REPLY IS 'ITR_REPLY : USER가 작성한 덧글을 DB에 저장';
COMMENT ON COLUMN ITR_REPLY.REPLYNUM IS 'REPLY 번호 : REPLY 번호';
COMMENT ON COLUMN ITR_REPLY.GALLERYNUM IS 'GALLERY 번호 : GALLERY 번호';
COMMENT ON COLUMN ITR_REPLY.ID IS 'USER 아이디 : USER 아이디';
COMMENT ON COLUMN ITR_REPLY.TEXT IS 'REPLY 내용 : REPLY 내용';
COMMENT ON COLUMN ITR_REPLY.INPUTDATE IS 'REPLY 작성 날짜 : REPLY 작성 날짜';
COMMENT ON TABLE ITR_USER IS 'ITR_USER : 기업회원이 아닌 가입된 USER의 정보';
COMMENT ON COLUMN ITR_USER.ID IS 'USER 아이디 : USER 아이디';
COMMENT ON COLUMN ITR_USER.PWD IS 'USER 비밀번호 : USER 비밀번호';
COMMENT ON COLUMN ITR_USER.NAME IS 'USER 이름 : USER 이름';
COMMENT ON COLUMN ITR_USER.EMAIL IS 'USER 이메일 : USER 이메일';
COMMENT ON COLUMN ITR_USER.GENDER IS 'USER 성별 : USER 성별';
COMMENT ON COLUMN ITR_USER.BIRTH IS 'USER 생년월일 : USER 생년월일';